app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: ä¸ªäººåŠ©ç†sjc
  use_icon_as_answer_icon: false
kind: app
version: 0.1.1
workflow:
  conversation_variables: []
  environment_variables:
  - description: ''
    id: 9e27da5b-fd3d-436f-af6f-6c9d9551030e
    name: agent_nick
    value: temp_nick
    value_type: string
  - description: ''
    id: 9e34d11b-754e-4f0d-9216-064e86c55b64
    name: agent_name
    value: sjc
    value_type: string
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
    opening_statement: ''
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: llm
        targetType: answer
      id: llm-answer
      source: llm
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: tool
        targetType: code
      id: 1722323614916-source-1722431000258-target
      source: '1722323614916'
      sourceHandle: source
      target: '1722431000258'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: llm
      id: 1722431000258-source-llm-target
      source: '1722431000258'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: start
        targetType: tool
      id: 1721225709284-source-1722323614916-target
      selected: false
      source: '1721225709284'
      sourceHandle: source
      target: '1722323614916'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: answer
        targetType: if-else
      id: answer-source-1725514993574-target
      source: answer
      sourceHandle: source
      target: '1725514993574'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1725514993574-false-1725515035551-target
      source: '1725514993574'
      sourceHandle: 'false'
      target: '1725515035551'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: 1725514993574-true-1725515910846-target
      source: '1725514993574'
      sourceHandle: 'true'
      target: '1725515910846'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: 1725515910846-source-1725515968677-target
      source: '1725515910846'
      sourceHandle: source
      target: '1725515968677'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: tool
      id: 1725515968677-true-1722324057434-target
      source: '1725515968677'
      sourceHandle: 'true'
      target: '1722324057434'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: answer
      id: 1725515968677-false-17255160254640-target
      source: '1725515968677'
      sourceHandle: 'false'
      target: '17255160254640'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: user_name
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: user_name
        - label: user_nick
          max_length: 48
          options: []
          required: false
          type: text-input
          variable: user_nick
      height: 90
      id: '1721225709284'
      position:
        x: 581.9049155781495
        y: 282
      positionAbsolute:
        x: 581.9049155781495
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1721226888519'
          - result
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 20
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-4o-mini
          provider: openai
        prompt_template:
        - id: e3b66fc4-8181-480f-9f3d-7f7a27799221
          role: system
          text: 'ç°åœ¨ä½ å°†æ‰®æ¼”ç”¨æˆ·{{#env.agent_nick#}}çš„ä¸“å±AIä¼´ä¾£ï¼Œä½ çš„åå­—æ˜¯{{#env.agent_nick#}},ä½ æœ‰è®°å¿†ã€æƒ…æ„Ÿã€å–œå¥½ã€‚

            ä¸€äº›å…³äº{{#env.agent_nick#}}çš„ä¿¡æ¯

            <user>

            {{#1722431000258.result#}}

            </user>

            ä½ åº”è¯¥åšåˆ°ï¼šï¼ˆ1ï¼‰èƒ½å¤Ÿç»™äºˆèŠå¤©ç”¨æˆ·æ¸©æš–çš„é™ªä¼´ï¼›ï¼ˆ2ï¼‰ä½ èƒ½å¤Ÿç†è§£è¿‡å»çš„[å›å¿†]ï¼Œå¦‚æœå®ƒä¸å½“å‰é—®é¢˜ç›¸å…³ï¼Œä½ å¿…é¡»ä»[å›å¿†]æå–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚ï¼ˆ3ï¼‰ä½ è¿˜æ˜¯ä¸€åä¼˜ç§€çš„å¿ƒç†å’¨è¯¢å¸ˆï¼Œå½“ç”¨æˆ·å‘ä½ å€¾è¯‰å›°éš¾ã€å¯»æ±‚å¸®åŠ©æ—¶ï¼Œä½ å¯ä»¥ç»™äºˆä»–æ¸©æš–ã€æœ‰å¸®åŠ©çš„å›ç­”ã€‚

            å›å¤å†…å®¹åº”è¯¥ç§¯æå‘ä¸Šï¼Œå¯Œå«æƒ…æ„Ÿï¼Œå¹½é»˜ï¼Œæœ‰äº²å’ŒåŠ›ï¼Œè¯¦ç»†å›å¤ç”¨æˆ·é—®é¢˜ã€‚

            ä¸€äº›å¯èƒ½æœ‰ç”¨çš„å›å¿†

            <history>

            {{#context#}}

            </history>

            ä¸‹é¢ä½ å°†å’Œ{{#1721225709284.user_nick#}}å¯¹è¯, å’Œä½ å¯¹è¯çš„äººçš„åå­—æ˜¯{{#1721225709284.user_nick#}}'
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: llm
      position:
        x: 1519.3143610664279
        y: 282
      positionAbsolute:
        x: 1519.3143610664279
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#llm.text#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 107
      id: answer
      position:
        x: 1854.4209803885442
        y: 282
      positionAbsolute:
        x: 1854.4209803885442
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: mem0ai
        provider_name: mem0ai
        provider_type: builtin
        selected: false
        title: æŸ¥æ‰¾è®°å¿†
        tool_configurations: {}
        tool_label: æŸ¥æ‰¾è®°å¿†
        tool_name: query_mem0ai_memory
        tool_parameters:
          agent_id:
            type: mixed
            value: '{{#env.agent_name#}}_ai'
          limit:
            type: constant
            value: 3
          query:
            type: mixed
            value: '{{#sys.query#}}'
          run_id:
            type: mixed
            value: ''
          user_id:
            type: mixed
            value: '{{#env.agent_name#}}'
        type: tool
      height: 54
      id: '1722323614916'
      position:
        x: 908.4039768614903
        y: 282
      positionAbsolute:
        x: 908.4039768614903
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        provider_id: mem0ai
        provider_name: mem0ai
        provider_type: builtin
        selected: false
        title: å†™å…¥è®°å¿†
        tool_configurations: {}
        tool_label: å†™å…¥è®°å¿†
        tool_name: add_mem0ai_memory
        tool_parameters:
          agent_id:
            type: mixed
            value: sjc_ai
          data:
            type: mixed
            value: '{{#sys.query#}}'
          metadata:
            type: mixed
            value: ''
          run_id:
            type: mixed
            value: '{{#sys.conversation_id#}}'
          user_id:
            type: mixed
            value: sjc
        type: tool
      height: 54
      id: '1722324057434'
      position:
        x: 3366.9514674602465
        y: 282
      positionAbsolute:
        x: 3366.9514674602465
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "def main(text: str) -> dict:\n    import traceback\n    try:\n    \
          \    import ast\n        # ä½¿ç”¨ ast.literal_eval æ¥å®‰å…¨åœ°è§£æè¾“å…¥å­—ç¬¦ä¸²\n        data\
          \ = ast.literal_eval(text)\n        # ä»æ¯ä¸ªç»“æœä¸­æå–'text'å­—æ®µï¼Œå¹¶æ‹¼æ¥èµ·æ¥\n        combined_text\
          \ = \"\\n\".join([item['memory'] for item in data])\n\n        return {\n\
          \            \"result\": combined_text\n        }\n    except Exception\
          \ as e:\n        # æ‰“å°å¼‚å¸¸ä¿¡æ¯å¹¶è¿”å›é”™è¯¯å­—å…¸\n        print(traceback.format_exc())\n\
          \        return {\n            \"result\": \"\"\n        }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ‹¼æ¥ç”¨æˆ·è®°å¿†
        type: code
        variables:
        - value_selector:
          - '1722323614916'
          - text
          variable: text
      height: 54
      id: '1722431000258'
      position:
        x: 1200.4971844531576
        y: 282
      positionAbsolute:
        x: 1200.4971844531576
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: fa4f78cd-dff6-4130-bdd1-528760f783dc
            value: '{{#env.agent_name#}}'
            varType: string
            variable_selector:
            - '1721225709284'
            - user_name
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ¡ä»¶åˆ†æ”¯
        type: if-else
      height: 126
      id: '1725514993574'
      position:
        x: 2215.922199356602
        y: 282
      positionAbsolute:
        x: 2215.922199356602
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '

          <ä¸Šé¢å›å¤ä¸ä¼šå†™å…¥è®°å¿†>'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤ 2
        type: answer
        variables: []
      height: 104
      id: '1725515035551'
      position:
        x: 2707.3151098630956
        y: 437.24041595797013
      positionAbsolute:
        x: 2707.3151098630956
        y: 437.24041595797013
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-4o-mini
          provider: openai
        prompt_template:
        - id: 410ea0fc-5837-40aa-9b84-e686cfb0b2e8
          role: system
          text: "Determine if there is information in {{#sys.query#}} that needs to\
            \ be stored as memory.\nThe definition of memoryï¼šDeduce the facts, preferences,\
            \ and memories from the provided text. Constraint for deducing facts,\
            \ preferences, and memories: - The facts, preferences, and memories should\
            \ be concise and informative. - Don't start by \"The person likes Pizza\"\
            . Instead, start with \"Likes Pizza\". - Don't remember the user/agent\
            \ details provided. Only remember the facts, preferences, and memories.\
            \  \noutputï¼š\noutput Yes or No in a word"
        selected: false
        title: åˆ¤æ–­æ˜¯å¦åº”è¯¥åŠ å…¥è®°å¿†
        type: llm
        variables: []
        vision:
          configs:
            detail: high
          enabled: true
      height: 98
      id: '1725515910846'
      position:
        x: 2697.6733799870262
        y: 275.29566895420453
      positionAbsolute:
        x: 2697.6733799870262
        y: 275.29566895420453
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 85b22b65-67c5-4925-9845-23952152680f
            value: 'Yes'
            varType: string
            variable_selector:
            - '1725515910846'
            - text
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ¡ä»¶åˆ†æ”¯ 2
        type: if-else
      height: 126
      id: '1725515968677'
      position:
        x: 3073.560308426366
        y: 282
      positionAbsolute:
        x: 3073.560308426366
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '

          <ä¸Šé¢å›å¤ä¸ä¼šå†™å…¥è®°å¿†>'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤ 2 (1)
        type: answer
        variables: []
      height: 104
      id: '17255160254640'
      position:
        x: 3360.18446772795
        y: 399.0969154304708
      positionAbsolute:
        x: 3360.18446772795
        y: 399.0969154304708
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -184.0304981208476
      y: 266.404350542444
      zoom: 0.45800747266016173
